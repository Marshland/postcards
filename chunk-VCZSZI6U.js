import{Ba as C,Ea as F,Fa as g,Ga as u,Ha as n,Ia as e,Ja as h,La as t,Ma as k,Na as o,Pa as _,Qa as y,Ra as D,Sa as w,Za as T,_a as $,fb as j,la as a,qa as f,ta as b}from"./chunk-XT2M5AV6.js";var N=(s,v)=>v.key,K=()=>[1,2,3,4];function z(s,v){s&1&&(n(0,"td"),t(1,"1"),e(),n(2,"td"),t(3,"2"),e(),n(4,"td"),t(5,"3"),e(),n(6,"td"),t(7,"4"),e(),n(8,"td"),t(9,"5"),e())}function A(s,v){if(s&1&&(n(0,"tr")(1,"td"),t(2),e(),n(3,"td"),t(4),e(),n(5,"td"),t(6),e(),n(7,"td"),t(8),e(),n(9,"td"),t(10),e(),n(11,"td"),t(12),e(),n(13,"td"),t(14),e(),n(15,"td"),t(16),e(),n(17,"td"),t(18),e(),n(19,"td"),t(20),e(),n(21,"td"),t(22),e(),n(23,"td"),t(24),e(),n(25,"td"),t(26),e(),n(27,"td"),t(28),e(),n(29,"td"),t(30),e(),n(31,"td"),t(32),e(),n(33,"td"),t(34),e(),n(35,"td"),t(36),e(),n(37,"td"),t(38),e(),n(39,"td"),t(40),e(),n(41,"td"),t(42),e()()),s&2){let i=v.$implicit;C("class",i.key),a(2),o(" ",i.key==="lunch"?"Pranzo":i.key==="dinner"?"Cena":"N.D."," "),a(2),o("",i.value.foodPercentage[1],"%"),a(2),o("",i.value.foodPercentage[2],"%"),a(2),o("",i.value.foodPercentage[3],"%"),a(2),o("",i.value.foodPercentage[4],"%"),a(2),o("",i.value.foodPercentage[5],"%"),a(2),o("",i.value.servicePercentage[1],"%"),a(2),o("",i.value.servicePercentage[2],"%"),a(2),o("",i.value.servicePercentage[3],"%"),a(2),o("",i.value.servicePercentage[4],"%"),a(2),o("",i.value.servicePercentage[5],"%"),a(2),o("",i.value.locationPercentage[1],"%"),a(2),o("",i.value.locationPercentage[2],"%"),a(2),o("",i.value.locationPercentage[3],"%"),a(2),o("",i.value.locationPercentage[4],"%"),a(2),o("",i.value.locationPercentage[5],"%"),a(2),o("",i.value.hospitalityPercentage[1],"%"),a(2),o("",i.value.hospitalityPercentage[2],"%"),a(2),o("",i.value.hospitalityPercentage[3],"%"),a(2),o("",i.value.hospitalityPercentage[4],"%"),a(2),o("",i.value.hospitalityPercentage[5],"%")}}function B(s,v){if(s&1&&(n(0,"div",1)(1,"h3"),t(2),e(),n(3,"table")(4,"tr"),h(5,"th"),n(6,"th",2),t(7,"Cibo"),e(),n(8,"th",2),t(9,"Servizio"),e(),n(10,"th",2),t(11,"Location"),e(),n(12,"th",2),t(13,"Accoglienza"),e()(),n(14,"tr"),h(15,"td"),g(16,z,10,0,null,null,F),e(),g(18,A,43,22,"tr",null,N),y(20,"keyvalue"),e()()),s&2){let i=v.$implicit;a(2),k(i.key),a(14),u(_(3,K)),a(2),u(D(20,1,i.value))}}var J=(()=>{class s{constructor(){this.total=0,this.totalClients=0,this.totalFriends=0,this.totalSocial=0,this.percentageClients="",this.percentageFriends="",this.percentageSocial="",this.statisticDays={},this.year=f(2024),this.month=f(1),this.jsonResource=$({request:()=>({year:this.year(),month:this.month()}),loader:async({request:{year:i,month:d}})=>(await fetch(`/data/${i}/${d}.json`)).json()}),T(()=>{let i=this.jsonResource.value();!i||this.jsonResource.isLoading()||this.calculate(i)})}calculate(i){for(let d in i){let m=i[d];for(let S in m){let E=m[S];for(let P in E){let I=E[P],l={lunch:{food:{1:0,2:0,3:0,4:0,5:0},foodPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},service:{1:0,2:0,3:0,4:0,5:0},servicePercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},location:{1:0,2:0,3:0,4:0,5:0},locationPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},hospitality:{1:0,2:0,3:0,4:0,5:0},hospitalityPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"}},dinner:{food:{1:0,2:0,3:0,4:0,5:0},foodPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},service:{1:0,2:0,3:0,4:0,5:0},servicePercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},location:{1:0,2:0,3:0,4:0,5:0},locationPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},hospitality:{1:0,2:0,3:0,4:0,5:0},hospitalityPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"}},unknown:{food:{1:0,2:0,3:0,4:0,5:0},foodPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},service:{1:0,2:0,3:0,4:0,5:0},servicePercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},location:{1:0,2:0,3:0,4:0,5:0},locationPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"},hospitality:{1:0,2:0,3:0,4:0,5:0},hospitalityPercentage:{1:"0.0",2:"0.0",3:"0.0",4:"0.0",5:"0.0"}}};for(let r in I){let x=I[r];this.total+=x?.length??0;for(let c of x??[])c.howKnowUs==="client"?this.totalClients++:c.howKnowUs==="friend"?this.totalFriends++:c.howKnowUs==="social"&&this.totalSocial++,l[r].food[c.food]++,l[r].service[c.service]++,l[r].location[c.location]++,l[r].hospitality[c.hospitality]++;for(let c in l[r].food){let p=+c;l[r].foodPercentage[p]=(l[r].food[p]/(x?.length??0)*100).toFixed(1)}for(let c in l[r].service){let p=+c;l[r].servicePercentage[p]=(l[r].service[p]/(x?.length??0)*100).toFixed(1)}for(let c in l[r].location){let p=+c;l[r].locationPercentage[p]=(l[r].location[p]/(x?.length??0)*100).toFixed(1)}for(let c in l[r].hospitality){let p=+c;l[r].hospitalityPercentage[p]=(l[r].hospitality[p]/(x?.length??0)*100).toFixed(1)}}this.statisticDays[`${P}/${S}/${d}`]=l}this.percentageClients=(this.totalClients/this.total*100).toFixed(1),this.percentageFriends=(this.totalFriends/this.total*100).toFixed(1),this.percentageSocial=(this.totalSocial/this.total*100).toFixed(1)}}}valueAscOrder(i,d){return+i.key>+d.key?1:+d.key>+i.key?-1:0}static{this.\u0275fac=function(d){return new(d||s)}}static{this.\u0275cmp=b({type:s,selectors:[["app-statistics"]],decls:27,vars:7,consts:[[1,"info"],[1,"day-statistic"],["colspan","5"]],template:function(d,m){d&1&&(n(0,"p",0)(1,"span")(2,"b"),t(3,"Totale cartoline:"),e(),t(4),e(),h(5,"br"),n(6,"span")(7,"b"),t(8,"Come ci hai conosciuto?"),e(),h(9,"br"),n(10,"span")(11,"b"),t(12,"Facebook:"),e(),t(13),e(),h(14,"br"),n(15,"span")(16,"b"),t(17,"Passaparola:"),e(),t(18),e(),h(19,"br"),n(20,"span")(21,"b"),t(22,"Cliente da tempo:"),e(),t(23),e()()(),g(24,B,21,4,"div",1,N),y(26,"keyvalue")),d&2&&(a(4),o(" ",m.total,""),a(9),o(" ",m.percentageSocial,"%"),a(5),o(" ",m.percentageFriends,"%"),a(5),o(" ",m.percentageClients,"%"),a(),u(w(26,4,m.statisticDays,m.valueAscOrder)))},dependencies:[j],styles:[`app-statistics{display:block}app-statistics .info{height:185px;display:flex;justify-content:center;flex-direction:column}app-statistics .day-statistic{height:195px}app-statistics th{border-top:1px solid}app-statistics td{width:61.5px}app-statistics th,app-statistics td{text-align:center;border-right:1px solid;border-bottom:1px solid}app-statistics .lunch{background-color:#fce5cd!important;color:#000}app-statistics .dinner{background-color:#d9ead3!important;color:#000}app-statistics .unknown{background-color:#d9d2e9!important;color:#000}
`],encapsulation:2,changeDetection:0})}}return s})();export{J as StatisticsComponent};
