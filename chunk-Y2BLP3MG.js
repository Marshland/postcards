import{c as v}from"./chunk-UCXKB2AN.js";import{Aa as b,Fb as E,N as h,Ta as s,Ua as r,Za as N,aa as p,ca as l,db as i,fb as d,nb as f,pa as c}from"./chunk-OIFITK5Y.js";var I=(()=>{class a{#e;constructor(){this.#e=h(E),this.contactsResource=v.text(()=>"./assets/data/contacts.vcf"),this.phoneNumbers=p(new Set),this.phoneNumbersToAdd=this.#e.allPhoneNumbers,this.phoneNumbersThatAreNotInContacts=f(()=>{let t=this.phoneNumbers(),e=this.phoneNumbersToAdd();return!t.size||!e.size?new Set:e.difference(t)}),l(()=>{let t=this.contactsResource.value();if(!t)return;let e=this.#t(t);this.phoneNumbers.set(new Set(e));let[n,o]=this.#n(t);console.log(n,o),this.#e.lastLetter.set(n),this.#e.lastNumber.set(o)})}downloadPhoneNumbersToAdd(){let t=this.phoneNumbersThatAreNotInContacts(),e=[];for(let o of t)e.push(this.#e.getVCard(o));let n=new Blob([e.join(`
`)],{type:"text/vcard"});this.#e.downloadFile(n,`phone-numbers-to-add-${this.#e.createDateStr()}.vcf`)}#t(t){return t.match(/^TEL;CELL:(.*)$/gm)?.map(e=>e.split(":")[1].trim())||[]}#n(t){let e="A",n=1;return t.match(/^FN;ENCODING=QUOTED-PRINTABLE;CHARSET=UTF-8:(.*)$/gm)?.forEach(o=>{let T=o.split(":")[1].trim(),[u,...g]=T.split(""),m=Number(g.join(""));Number.isNaN(m)||(u>e?(e=u,n=m):u===e&&m>n&&(n=m))}),[e,n]}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275cmp=b({type:a,selectors:[["app-phone-numbers"]],decls:9,vars:3,consts:[[3,"click"]],template:function(e,n){e&1&&(s(0,"div"),i(1),r(),s(2,"div"),i(3),r(),s(4,"div"),i(5),r(),s(6,"div")(7,"button",0),N("click",function(){return n.downloadPhoneNumbersToAdd()}),i(8,"Download phone numbers to add"),r()()),e&2&&(c(),d("total phone numbers: ",n.phoneNumbers().size),c(2),d("total phone numbers to add: ",n.phoneNumbersToAdd().size),c(2),d("phone numbers that are not in contacts: ",n.phoneNumbersThatAreNotInContacts().size))},encapsulation:2,changeDetection:0})}}return a})();export{I as PhoneNumbersComponent};
