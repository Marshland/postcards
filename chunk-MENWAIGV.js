import{L as h,Xa as p,Za as u,a as i,qa as l}from"./chunk-XT2M5AV6.js";var P=(()=>{class c{constructor(){this.postcards=l(JSON.parse(localStorage.getItem("postcards")??"{}")),this.lastInsertedPostcards=l([]),this.totalPostcards=p(()=>{let s=this.postcards();return Object.values(s).reduce((t,o)=>t+Object.values(o).reduce((e,r)=>e+Object.values(r).reduce((a,n)=>a+Object.values(n).reduce((d,f)=>d+f.length,0),0),0),0)}),this.#t=u(()=>{localStorage.setItem("postcards",JSON.stringify(this.postcards()))})}#t;reloadPostcards(){this.postcards.set(JSON.parse(localStorage.getItem("postcards")??"{}"))}addPostcard(s){let t=this.postcards(),{year:o,month:e,day:r,serviceType:a}=s;t[o]||(t[o]={}),t[o][e]||(t[o][e]={}),t[o][e][r]||(t[o][e][r]={}),t[o][e][r][a]||(t[o][e][r][a]=[]),t[o][e][r][a].push({food:s.food,service:s.service,location:s.location,hospitality:s.hospitality,howKnowUs:s.howKnowUs,email:s.email,phone:s.phone}),this.postcards.set(i({},t)),this.#s(s)}deletePostcard(s){let t=this.postcards(),{year:o,month:e,day:r,serviceType:a}=s,n=t[o][e][r][a]?.findIndex(d=>d===s);n===void 0||n<0||(t[o][e][r][a]?.splice(n,1),this.postcards.set(i({},t)),this.#e(s))}exportPostcards(){let s=this.postcards(),t=new Blob([JSON.stringify(s,void 0,2)],{type:"application/json"}),o=URL.createObjectURL(t),e=document.createElement("a");e.href=o;let r=new Date,a=`${r.getFullYear()}-${r.getMonth()}-${r.getDate()}_${r.getHours()}-${r.getMinutes()}-${r.getSeconds()}`;e.download=`postcards-${a}.json`,document.body.appendChild(e),e.click(),e.remove(),this.postcards.set({})}#s(s){let t=this.lastInsertedPostcards();t.push(s),t.length>10&&t.shift(),this.lastInsertedPostcards.set(t)}#e(s){let t=this.lastInsertedPostcards(),o=t.findIndex(e=>e===s);o<0||(t.splice(o,1),this.lastInsertedPostcards.set(t))}static{this.\u0275fac=function(t){return new(t||c)}}static{this.\u0275prov=h({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();export{P as a};
